I"¨"  <video autoplay loop muted class="gifvid">
    <source src="/assets/Reaper/Keytrack/MainTrack.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <div class="video-caption">Midi notes modulating parameter values</div>

<p>Keytracking is a capability that many synthesizers have. It allows you to modulate a parameter by the value of the incoming midi note.</p>

<p>This capability is very useful to be applied outside of a synthesizer. Perhaps you want your higher frequency synth notes to have more reverb than the lower frequency notes, or maybe you want an LFO to be less drastic when youâ€™re playing bass notes.</p>

<p>Iâ€™ve written a JSFX script for reaper that allows you to use midi-note values to modulate parameters. Let me show you how to use it.</p>

<!--more-->

<h1 class="no_toc" id="contents">Contents</h1>
<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#the-script" id="markdown-toc-the-script">The script</a></li>
  <li><a href="#how-to-use" id="markdown-toc-how-to-use">How to use</a>    <ul>
      <li><a href="#midi-track" id="markdown-toc-midi-track">Midi Track</a></li>
      <li><a href="#non-midi-track" id="markdown-toc-non-midi-track">Non-Midi Track</a>        <ul>
          <li><a href="#stage-1" id="markdown-toc-stage-1">Stage 1</a></li>
          <li><a href="#stage-2" id="markdown-toc-stage-2">Stage 2</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
  <li><a href="#support-me" id="markdown-toc-support-me">Support Me!</a></li>
</ul>

<h1 id="introduction">Introduction</h1>

<p>Hereâ€™s a quick overview of what weâ€™re doing.</p>

<ul>
  <li>We load the JSFX Keytracker on our track. It has a slider that corresponds to the current note-value, on the current channel.</li>
  <li>We use Reaperâ€™s â€œLink from Midi or FX Parameterâ€ to link our desired control to the JSFX Keytracker</li>
</ul>

<p>When an midi note is input to the JSFX Keytracker, the slider changes to reflect the note. Weâ€™ve linked another parameter to this, and our note value (0-127) is turn in to a percentage of the slider value (0-100%). This modulates our parameter.</p>

<h1 id="the-script">The script</h1>

<p>The following code is the script. You can either create a new file and drop this in it, or [download from here].(/assets/Reaper/Keytrack/KeyTracker).</p>

<p>To find the location of where to put this:</p>

<ul>
  <li>Open Reaper</li>
  <li>Options menu-&gt;Show RESOURCE path in explorer/finder</li>
  <li>Open the â€œEffectsâ€ folder</li>
  <li>Create a new folder (â€˜AdmiralBumbleBeeâ€™ if you wish)</li>
  <li>Place this file in it</li>
</ul>

<p>Now it will show in your JS effects list as â€œKeyTrack Generatorâ€</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre>desc: Keytrack generator
//tags: Key track follow generator link
//author: Robert Randolph

slider1:0&lt;0,127,1&gt;Midi Note Value
slider2:0&lt;0,15,1{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16}&gt;Input Channel
slider3:0&lt;0,1,1{Note On, Note Off}&gt;Trigger

in_pin:none
out_pin:none

@init

noteOn = $x90;
noteOff = $x80;

@slider
inChannel = slider2;
noteTrig = slider3

@block

while (midirecv(offset,msg1,msg2,msg3)) ( 
    channel = msg1 &amp; $x0F;
    onOffStatus = msg1 &amp; $xF0; // 144 == Note On, 128 == Note Off

    trigTest = noteTrig == 0 ? (noteOn):(noteOff); // comparison value based on our note on/off setting

    channel == inChannel ? (
        trigTest == onOffStatus ? (
            slider1 = msg2;
        )
    );
    
    midisend(offset,msg1,msg2,msg3); // pass through
);
</pre></td></tr></tbody></table></code></pre></div></div>
<h1 id="how-to-use">How to use</h1>

<p>Thereâ€™s 2 ways you may wish to use this: on a track taking midi input, or on a track not taking midi input.</p>

<p>I will explain how to set it up on both.</p>

<h2 id="midi-track">Midi Track</h2>

  <video autoplay loop muted class="gifvid">
    <source src="/assets/Reaper/Keytrack/SetupTrack.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <div class="video-caption">Linking keytracker to a parameter</div>

<p>Setting it up on a midi track is simple.</p>

<ul>
  <li>Place Keytrack Generator as the first plug-in on the track with a parameter that you wish to modulate.</li>
  <li>Wiggle the parameter (from a plug-in on the same track) that you wish to have keytracked.</li>
  <li>Click the â€œParamâ€ menu in the upper right of the window.</li>
  <li>Select â€œParameter modulation/MIDI linkâ€.</li>
  <li>In the new window check â€œLink from MIDI or FX Parameterâ€.</li>
  <li>In the first box select â€œKeytrack generator:â€ then â€œMidi Note Valueâ€.</li>
</ul>

<p>Now youâ€™re done. <strong>Thatâ€™s it.</strong></p>

<p>The parameter that you linked will now change depending on the note you play. You can adjust the offset and scale in the parameter modulation window to get the values synced up how you want.</p>

<h2 id="non-midi-track">Non-Midi Track</h2>

<p>Setting it up on a track that doesnâ€™t have midi input is only slightly different. Iâ€™ve broken this setup in to 2 stages.</p>

<h3 id="stage-1">Stage 1</h3>

  <img src="/assets/Reaper/Keytrack/MidiRoute.png" alt="Rout Midi">
  <div class="image-caption">Route the midi</div>

<ul>
  <li>Create a track.</li>
  <li>Drag from the midi track â€˜Routeâ€™ box to the audio track â€˜Routeâ€™ box. (see arrows in image)</li>
  <li>Set the track to have a midi input (with monitoring on), or some midi note data in an item. This is the midi that will modulate your destination track.</li>
  <li>Send the midi from your midi track to the track that has the parameter(s) that you wish to modulate.
    <ul>
      <li>Make sure you donâ€™t send audio. It isnâ€™t necessary and may confuse you later</li>
      <li>Confirm that midi is being routed.</li>
    </ul>
  </li>
</ul>

<h3 id="stage-2">Stage 2</h3>

<p>Stage 2 is identical to the <a href="#midi-track">midi track section</a>. The difference is that our midi is coming from another track in the project rather than the track with the parameter that weâ€™re modulating. Thatâ€™s why we setup the send in stage 1.</p>

<ul>
  <li>Place Keytrack Generator as the first plug-in on the track with a parameter that you wish to modulate.</li>
  <li>Wiggle the parameter (from a plug-in on the same track) that you wish to have keytracked.</li>
  <li>Click the â€œParamâ€ menu in the upper right of the window.</li>
  <li>Select â€œParameter modulation/MIDI linkâ€.</li>
  <li>In the new window check â€œLink from MIDI or FX Parameterâ€.</li>
  <li>In the first box select â€œKeytrack generator:â€ then â€œMidi Note Valueâ€.</li>
</ul>

<h1 id="conclusion">Conclusion</h1>

<p>Thatâ€™s really all there is to it! This is a fantastic way to create special effects that are tied to the specific midi-input note.</p>

<p>Remember as well that <a href="/music/2017/04/18/Reapers-Amazing,-but-Awful,-Almost-Anything-to-Anywhere-Routing.html">Reaperâ€™s routing is pretty fantastic</a> and you can <a href="/music/2017/07/25/Control-multiple-parameters-across-tracks-in-Reaper-with-faders.html">also do some crazy multi-routing</a> with Reaper. This all applies to this post as well. Get creative! Thereâ€™s a lot of potential here!</p>

<p>If you want to modulate a parameter by the pitch of audio, then thereâ€™s a way to do that tooâ€¦ <a href="/music/2017/08/06/Realtime-pitch-tracked-EQ-bands-in-ReaEQ.html">but thatâ€™s another blog post.</a></p>

<h1 id="support-me">Support Me!</h1>

<p>This post took 4 hours to research, screenshot, write and edit. If you appreciate the information presented then <a href="/DonateNow/">please consider joining patreon or donating!</a></p>

<p><a href="https://www.patreon.com/bePatron?u=7465992"> <img class="patreon-button" src="/assets/Patreon.png" alt="Be a Patreon!" /></a></p>

<form style="text-align: center;" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="BR247JAZBTUJJ" />
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!" />
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1" />
</form>

<p>If you have any questions or comments, please comment below! I read every comment and respond to most.</p>

:ET