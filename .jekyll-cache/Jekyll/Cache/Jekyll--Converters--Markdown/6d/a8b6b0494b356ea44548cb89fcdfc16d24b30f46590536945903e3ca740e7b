I"©#  <video autoplay loop muted class="gifvid">
    <source src="/assets/Reaper/Keytrack/ReaSurfing.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <div class="video-caption">Tracking synthesizer audio then voice</div>

<p>If you read <a href="/music/2017/08/06/Keytrack-any-parameter-in-Reaper-with-this-script.html">my post on Keytracking</a> then maybe you saw that I implied that you can use the pitch of any audio signal.</p>

<p>So let me share how you can modulate the frequency value of a ReaEQ band by the incoming audio‚Äôs pitch!</p>

<!--more-->

<h1 class="no_toc" id="contents">Contents</h1>
<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#the-script" id="markdown-toc-the-script">The Script</a>    <ul>
      <li><a href="#script-extras" id="markdown-toc-script-extras">Script extras</a></li>
    </ul>
  </li>
  <li><a href="#setup" id="markdown-toc-setup">Setup</a></li>
  <li><a href="#other-plug-ins" id="markdown-toc-other-plug-ins">Other plug-ins</a></li>
  <li><a href="#support-me" id="markdown-toc-support-me">Support Me!</a></li>
</ul>

<h1 id="introduction">Introduction</h1>

<p>The idea here is fairly simple. We use ReaTune to send out midi, then we use a custom JSFX plug-in to create a slider that corresponds to the frequency of the midi note ReaTune is outputting. Now we can link anything to that slider, like a ReaEQ band.</p>

<h1 id="the-script">The Script</h1>

<p>The following code is the script. You can either create a new file and drop this in it, or <a href="/assets/Reaper/Keytrack/KeyTrackerEQ">download from here</a>.</p>

<p>To find the location of where to put this:</p>

<ul>
  <li>Open Reaper</li>
  <li>Options menu-&gt;Show RESOURCE path in explorer/finder</li>
  <li>Open the ‚ÄúEffects‚Äù folder</li>
  <li>Create a new folder (‚ÄòAdmiralBumbleBee‚Äô if you wish)</li>
  <li>Place this file in it</li>
</ul>

<p>Now it will show in your JS effects list as ‚ÄúKeyTrack Generator ReaEQ edition‚Äù</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class="rouge-code"><pre>desc: Keytrack generator - ReaEQ edition
//tags: Key track follow generator link
//author: Robert Randolph

slider1:0&lt;0,24000,1&gt;Midi Note Frequency 
slider2:440&lt;420,460,1&gt;Base Frequency
slider3:0&lt;-4,4,1&gt;Octave Offset
slider4:0&lt;0,4,1&gt;Harmonic Offset
slider5:0&lt;0,15,1{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16}&gt;Input Channel
slider6:0&lt;0,1,1{Note On, Note Off}&gt;Trigger

in_pin:none
out_pin:none

@init

noteOn = $x90;
noteOff = $x80;

@slider
baseFreq = slider2;
octOffset = slider3;
baseOffset = slider4;
inChannel = slider5;
noteTrig = slider6;

@block

while (midirecv(offset,msg1,msg2,msg3)) ( 
    channel = msg1 &amp; $x0F;
    onOffStatus = msg1 &amp; $xF0; // 144 == Note On, 128 == Note Off

    trigTest = noteTrig == 0 ? (noteOn):(noteOff); // comparison value based on our note on/off setting

    channel == inChannel ? (
        trigTest == onOffStatus ? (
            incNote = msg2;
            useNote = incNote + (octOffset * 12); // change octave of incoming note
            noteFreq = ((baseFreq / 32) * (2 ^ ((useNote - 9) / 12))); // Midi note to frequency
            noteFreqOff = noteFreq + (baseOffset * noteFreq); // Harmonic offset
            slider1 = noteFreqOff;
        )
    );
    
    midisend(offset,msg1,msg2,msg3); // pass through
);
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="script-extras">Script extras</h2>

<p>This script has some extra functions <a href="/music/2017/08/06/Keytrack-any-parameter-in-Reaper-with-this-script.html#the-script">compared to the other one</a>.</p>

<ul>
  <li>Base Frequency - This is your a=XXXhz tuning reference. Set this to the tuning reference of the instrument you‚Äôre using.</li>
  <li>Octave Offset - This offsets the output value by N octaves. 2 Octaves up from 440hz is 1,760hz.</li>
  <li>Harmonic Offset - This offsets the output by 1 harmonic value. 2 Harmonics up from 880hz is 2,640hz, where 2 octaves up would be 3,520hz.</li>
</ul>

<h1 id="setup">Setup</h1>

  <video autoplay loop muted class="gifvid">
    <source src="/assets/Reaper/Keytrack/SurferSetup.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <div class="video-caption">Setting up the surfer</div>

<p>Setup is very simple, and you may already know what you need to do if you <a href="/music/2017/08/06/Keytrack-any-parameter-in-Reaper-with-this-script.html#the-script">read the other post</a></p>

<ul>
  <li>Add ‚ÄúReaTune‚Äù to our audio track.
    <ul>
      <li>Turn on ‚ÄúSend MIDI events when pitch changes‚Äù</li>
    </ul>
  </li>
  <li>Add ‚ÄúKeytrack generator - ReaEQ edition‚Äù to our audio track</li>
  <li>Add ReaEQ to our audio track.
    <ul>
      <li>Turn <strong>OFF</strong> the to-be-modulated EQ band ‚ÄúLog-scale automated frequencies‚Äù</li>
    </ul>
  </li>
  <li>Parameter link the ‚ÄúKeytrack generator - ReaEQ edition‚Äù to the frequency of our ReaEQ band.
    <ul>
      <li>Wiggle the frequency of the band that you wish to have keytracked.</li>
      <li>Click the ‚ÄúParam‚Äù menu in the upper right of the window.</li>
      <li>Select ‚ÄúParameter modulation/MIDI link‚Äù.</li>
      <li>In the new window check ‚ÄúLink from MIDI or FX Parameter‚Äù.</li>
      <li>In the first box select ‚ÄúKeytrack generator:‚Äù then ‚ÄúMidi Note Value‚Äù.</li>
    </ul>
  </li>
</ul>

<p>That‚Äôs it!</p>

<p><strong>Keep in mind that the keytracking script doesn‚Äôt update parameters until a new note comes in.</strong></p>

<h1 id="other-plug-ins">Other plug-ins</h1>

<p>If you want to use another plug-in then you may need to adjust for the logarithmic scale used by that plug-in. Here‚Äôs a script that works for something like <a href="https://www.fabfilter.com/products/pro-q-2-equalizer-plug-in">Fabfilter Pro-Q 2</a></p>

<p>The ‚ÄòminVal‚Äô and ‚ÄòmaxVal‚Äô variables need to be changed to the minimum and maximum frequency of your EQ.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre>desc: Keytrack generator - Log scale Edition
//tags: Key track follow generator link
//author: Robert Randolph

slider1:0&lt;0,100,1&gt;Midi Note Frequency 
slider2:440&lt;420,460,1&gt;Base Frequency
slider3:0&lt;-4,4,1&gt;Octave Offset
slider4:0&lt;0,4,1&gt;Harmonic Offset
slider5:0&lt;0,15,1{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16}&gt;Input Channel
slider6:0&lt;0,1,1{Note On, Note Off}&gt;Trigger

in_pin:none
out_pin:none

@init

noteOn = $x90;
noteOff = $x80;
minVal = 10;
maxVal = 30000;
logDelta = log(maxVal / minVal)

@slider
baseFreq = slider2;
octOffset = slider3;
baseOffset = slider4;
inChannel = slider5;
noteTrig = slider6;

@block

while (midirecv(offset,msg1,msg2,msg3)) ( 
    channel = msg1 &amp; $x0F;
    onOffStatus = msg1 &amp; $xF0; // 144 == Note On, 128 == Note Off

    trigTest = noteTrig == 0 ? (noteOn):(noteOff); // comparison value based on our note on/off setting

    channel == inChannel ? (
        trigTest == onOffStatus ? (
            incNote = msg2;
            useNote = incNote + (octOffset * 12); // change octave of incoming note
            noteFreq = ((baseFreq / 32) * (2 ^ ((useNote - 9) / 12))); // Midi note to frequency
            noteFreqOff = noteFreq + (baseOffset * noteFreq); // Harmonic offset
            slider1 = log(noteFreqOff / minVal) / logDelta * 100;
        )
    );
    
    midisend(offset,msg1,msg2,msg3); // pass through
);
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="support-me">Support Me!</h1>

<p>This post took 7 total hours to research, screenshot, write and edit. If you appreciate the information presented then <a href="/DonateNow/">please consider joining patreon or donating!</a></p>

<p><a href="https://www.patreon.com/bePatron?u=7465992"> <img class="patreon-button" src="/assets/Patreon.png" alt="Be a Patreon!" /></a></p>

<form style="text-align: center;" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="BR247JAZBTUJJ" />
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!" />
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1" />
</form>

<p>If you have any questions or comments, please comment below! I read every comment and respond to most.</p>

:ET